#import NonEmptyString, Sidereal, TargetId, Nonsidereal from "lucuma/schemas/ObservationDB.graphql"
#import SiderealInput, NonsiderealInput, WavelengthInput, AngleInput from "lucuma/schemas/ObservationDB.graphql"
#import Long, BigDecimal, Timestamp, TimeSpanInput from "lucuma/schemas/ObservationDB.graphql"

"""Target properties input"""
input TargetPropertiesInput {
  id: TargetId!
  name: NonEmptyString!
  sidereal: SiderealInput
  nonsidereal: NonsiderealInput
  wavelength: WavelengthInput
}

type Distance {
    micrometers: Long!
    millimeters: BigDecimal!
}

input DistanceInput {
    micrometers: Long
    millimeters: BigDecimal
}

type PointOrigin {
    x: Distance!
    y: Distance!
}

input PointOriginInput {
    x: DistanceInput!
    y: DistanceInput!
}

input InstrumentSpecificsInput {
    iaa: AngleInput!
    focusOffset: DistanceInput!
    agName: String!
    origin: PointOriginInput!
}

"""Slew Options input"""
input SlewOptionsInput {
    zeroChopThrow:            Boolean!
    zeroSourceOffset:         Boolean!
    zeroSourceDiffTrack:      Boolean!
    zeroMountOffset:          Boolean!
    zeroMountDiffTrack:       Boolean!
    shortcircuitTargetFilter: Boolean!
    shortcircuitMountFilter:  Boolean!
    resetPointing:            Boolean!
    stopGuide:                Boolean!
    zeroGuideOffset:          Boolean!
    zeroInstrumentOffset:     Boolean!
    autoparkPwfs1:            Boolean!
    autoparkPwfs2:            Boolean!
    autoparkOiwfs:            Boolean!
    autoparkGems:             Boolean!
    autoparkAowfs:            Boolean!
}

enum ParkStatus {
    NOT_PARKED
    PARKED
}

enum FollowStatus {
    NOT_FOLLOWING
    FOLLOWING
}

type MountStatus {
    parked: ParkStatus!
    follow: FollowStatus!
}

type TelescopeStatus {
    mount: MountStatus!
}

input GuiderConfig{
    target: TargetPropertiesInput!
    tracking: ProbeTrackingInput!
}

input TcsConfigInput {
    sourceATarget: TargetPropertiesInput!
    instParams: InstrumentSpecificsInput!
    oiwfs: GuiderConfig
    rotator: RotatorTrackingInput!
}

enum RotatorTrackingMode {
    TRACKING
    FIXED
}

input RotatorTrackingInput {
    ipa: AngleInput!
    mode: RotatorTrackingMode!
}

input ProbeTrackingInput {
    nodAchopA: Boolean!
    nodAchopB: Boolean!
    nodBchopA: Boolean!
    nodBchopB: Boolean!
}

type Target {
  """Target ID"""
  id: TargetId!

  """Target name."""
  name: NonEmptyString!

  """Sidereal tracking information, if this is a sidereal target"""
  sidereal: Sidereal

  """Nonsidereal tracking information, if this is a nonsidereal target"""
  nonsidereal: Nonsidereal
}

enum TipTiltSource {
    OIWFS
}

enum M1CorrectionSource {
    OIWFS
}

type GuideConfigurationState {
    """M2 Tip-Tilt correction sources. An empty array means no corrections"""
    m2Inputs: [TipTiltSource!]
    """M2 coma correction enabled. Only valid if m2Inputs and m1Input are defined"""
    m2Coma: Boolean
    """M1 correction source. If it is not defined it means no M1 correction"""
    m1Input: M1CorrectionSource
    """Tip-tilt offload to the mount enabled"""
    mountOffload: Boolean!
}

input GuideConfigurationInput {
    """M2 Tip-Tilt correction sources. An empty array means no corrections"""
    m2Inputs: [TipTiltSource!]
    """M2 coma correction enabled. Only valid if m2Inputs and m1Input are defined"""
    m2Coma: Boolean
    """M1 correction source. If it is not defined it means no M1 correction"""
    m1Input: M1CorrectionSource
    """Tip-tilt offload to the mount enabled"""
    mountOffload: Boolean!
}

enum LogLevel {
    ERROR
    WARN
    INFO
    DEBUG
    TRACE
}

type LogMessage {
    timestamp: Timestamp!
    level: LogLevel!
    thread: String!
    message: String!
}

enum OperationResult {
    SUCCESS
    FAILURE
}

type OperationOutcome {
    result: OperationResult!
    msg: String
}

type Query {
    """telescopeStatus: TelescopeStatus!"""
    guideState: GuideConfigurationState!
}

type Mutation {
    mountPark: OperationOutcome!
    mountFollow(enable: Boolean!): OperationOutcome!
    rotatorPark: OperationOutcome!
    rotatorFollow(enable: Boolean!): OperationOutcome!
    slew(slewOptions: SlewOptionsInput!, config: TcsConfigInput!): OperationOutcome!
    tcsConfig(config: TcsConfigInput!): OperationOutcome!
    instrumentSpecifics(instrumentSpecificsParams: InstrumentSpecificsInput!): OperationOutcome!
    rotatorConfig(config: RotatorTrackingInput!): OperationOutcome!
    oiwfsTarget(target: TargetPropertiesInput!): OperationOutcome!
    oiwfsProbeTracking(config: ProbeTrackingInput!): OperationOutcome!
    oiwfsPark: OperationOutcome!
    oiwfsFollow(enable: Boolean!): OperationOutcome!
    oiwfsObserve(period: TimeSpanInput!): OperationOutcome!
    oiwfsStopObserve: OperationOutcome!
    guideEnable(config: GuideConfigurationInput!): OperationOutcome!
    guideDisable: OperationOutcome!
}

type Subscription {
    logMessage: LogMessage!
    guideState: GuideConfigurationState!
}